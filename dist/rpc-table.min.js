class RpcTable{#e;#t;#s;get tableHeaders(){return[...this.#e.querySelectorAll("tr:nth-child(1) th")].map((e=>e.innerText))}#l;constructor(e,t={}){if(this.#e=document.querySelector(e),!this.#e)throw new Error("Invalid selector");this.#e.classList.add("rpc"),this.#t=[],this.#s=t.breakpoints||{"collapse-xs":576,"collapse-sm":768,"collapse-md":992,"collapse-lg":1200,collapse:Number.MAX_SAFE_INTEGER},this.#l=t.resizeTimeout||150,this.process(),this.#e.addEventListener("click",(e=>{if(!e.target.classList.contains("rpc-toggler"))return;let t=e.target.closest("tr");t.classList.contains("rpc-expanded")?t.nextSibling.remove():t.after(this.#t[t.dataset.childIndex]),t.classList.toggle("rpc-expanded")})),window.addEventListener("resize",this.#i.bind(this))}process(){this.#t=[],this.#e.querySelectorAll("tbody tr:not(.child)").forEach((e=>{let t=Object.assign(document.createElement("tr"),{classList:["child"],colspan:"100%",innerHTML:`<td colspan="100%"><ul data-row="${e.rowIndex}"></ul></td>`});e.querySelectorAll("td").forEach(((e,s)=>{e.classList.contains("rpc-hidden")&&t.querySelector("td > ul").appendChild(this.#r(e))})),e.dataset.childIndex=this.#t.length,e.dataset.row=e.rowIndex,this.#t.push(t)})),this.render()}render(){this.#a(),this.#e.querySelectorAll("tbody tr:not(.child)").forEach((e=>{let t=this.#t[e.dataset.childIndex],s=t.querySelector("tr > td > ul");for(let l of e.cells)if(!l.classList.contains("rpc-hidden")||this.#n(t,e.dataset.row,l.cellIndex)){if(l.classList.contains("rpc-hidden")||!this.#n(t,e.dataset.row,l.cellIndex));else for(let t of s.getElementsByTagName("li"))if(t.dataset.column==l.cellIndex){for(let s of this.#e.rows){if(s.dataset.row!=e.dataset.row)continue;let l=t.querySelector(".rpc-child-value");l.children.length>0?this.#e.rows[s.rowIndex].cells[parseInt(t.dataset.column)].append(...l.children):this.#e.rows[s.rowIndex].cells[parseInt(t.dataset.column)].innerHTML=l.innerHTML,t.remove()}break}}else{let e=s.children.length;for(;;){if(0==e){s.prepend(this.#r(l));break}if(e--,l.cellIndex>s.children[e].dataset.column){s.children[e].after(this.#r(l));break}}}e.querySelector("td.rpc-toggler")?.classList.remove("rpc-toggler"),s.children.length>0?(e.classList.add("has-child"),e.querySelector("td:not(.rpc-hidden)").classList.add("rpc-toggler")):(e.classList.remove("has-child"),e.classList.contains("rpc-expanded")&&(this.#e.rows[e.rowIndex+1].remove(),e.classList.remove("rpc-expanded")))}))}hiddenClasses(){return Object.keys(this.#s).filter((e=>this.#s[e]>=window.innerWidth))}#a(){this.#e.querySelectorAll("thead > tr > th").forEach(((e,t)=>{let s=[...e.classList].filter((e=>Object.keys(this.#s).includes))[0];this.#e.querySelectorAll(`tbody tr:not(.child) td:nth-child(${t+1})`).forEach((t=>{s&&t.classList.add(s),s&&this.hiddenClasses().includes(s)?(e.classList.add("rpc-hidden"),t.classList.add("rpc-hidden")):(e.classList.remove("rpc-hidden"),t.classList.remove("rpc-hidden"))}))}))}#n(e,t,s){let l=e.querySelector("ul");for(let e of l.getElementsByTagName("li"))if(l.dataset.row==t&&e.dataset.column==s)return!0;return!1}#r(e){let t=document.createElement("li");return t.dataset.column=e.cellIndex,t.appendChild(Object.assign(document.createElement("span"),{classList:["rpc-child-title"],innerHTML:this.tableHeaders[e.cellIndex]})),t.appendChild(Object.assign(document.createElement("span"),{classList:["rpc-child-value"]})),e.children.length>0?t.children[1].append(...e.children):t.children[1].innerHTML=e.innerText,t}#i(e){clearTimeout(this.#l),this.#l=setTimeout(this.render.bind(this),this.#l)}}