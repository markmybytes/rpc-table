class RpcTable{get tableHeaders(){return[...this.#a.querySelectorAll("tr:nth-child(1) th")].map(e=>e.innerText)}#a;#b;#c;#d;constructor(e,t={}){if(this.#a=document.querySelector(e),!this.#a)throw Error("Invalid selector");this.#a.classList.add("rpc"),this.#b=t.breakpoints||{"collapse-xs":576,"collapse-sm":768,"collapse-md":992,"collapse-lg":1200,collapse:Number.MAX_SAFE_INTEGER},this.#d=null,this.#c=parseInt(t.resizeTimeout)||150,this.process(),this.#a.addEventListener("click",this.#e.bind(this)),(!t.hasOwnProperty("renderOnResize")||t.hasOwnProperty("renderOnResize")&&t.renderOnResize)&&window.addEventListener("resize",this.#f.bind(this))}process(){this.#a.querySelectorAll("tbody tr:not(.child)").forEach(e=>{e.dataset.row=e.rowIndex}),this.#a.querySelectorAll("thead > tr > th").forEach((e,t)=>{let s=[...e.classList].filter(e=>Object.keys(this.#b).includes);0!=s.length&&this.#a.querySelectorAll(`tbody tr:not(.child) td:nth-child(${t+1})`).forEach(e=>{e.classList.add(s[0])})}),this.#g(),this.#h()}render(){this.#g(),this.#a.querySelectorAll("tbody > tr.rpc-expanded").forEach(e=>{let t=e.nextSibling.getElementsByClassName("rpc-details")[0];for(let s of e.cells){if(s.classList.contains("rpc-hidden")&&!this.#i(t,s.cellIndex)){let l=t.children.length;for(;;){if(0==l){t.prepend(this.#j(s));break}if(l--,s.cellIndex>t.children[l].dataset.column){t.children[l].after(this.#j(s));break}}continue}if(!s.classList.contains("rpc-hidden")&&this.#i(t,s.cellIndex))for(let r of t.getElementsByTagName("li")){if(parseInt(r.dataset.column)!=s.cellIndex)continue;let i=r.getElementsByClassName("rpc-data")[0];i.children.length>0&&e.cells[parseInt(r.dataset.column)].append(...i.children),r.remove()}}}),this.#h()}hiddenClasses(){return Object.keys(this.#b).filter(e=>this.#b[e]>=window.innerWidth)}#i(e,t){for(let s of e.getElementsByTagName("li"))if(parseInt(s.dataset.column)==t)return!0;return!1}#j(l){let r=document.createElement("li");return r.dataset.column=l.cellIndex,r.appendChild(Object.assign(document.createElement("span"),{classList:["rpc-title"],innerHTML:this.tableHeaders[l.cellIndex]})),r.appendChild(Object.assign(document.createElement("span"),{classList:["rpc-data"]})),l.children.length>0?r.children[1].append(...l.children):r.children[1].innerHTML=l.innerText,r}#g(){this.#a.querySelectorAll("thead > tr > th").forEach((e,t)=>{let s=[...e.classList].filter(e=>Object.keys(this.#b).includes(e));0!=s.length&&this.#a.querySelectorAll(`tbody tr:not(.child) td:nth-child(${t+1})`).forEach(t=>{this.hiddenClasses().includes(s[0])?(e.classList.add("rpc-hidden"),t.classList.add("rpc-hidden")):(e.classList.remove("rpc-hidden"),t.classList.remove("rpc-hidden"))})})}#h(){this.#a.querySelectorAll("tbody > tr:not(.child)").forEach(e=>{e.querySelector("td.rpc-toggler")?.classList.remove("rpc-toggler"),e.querySelector("td.rpc-hidden")?(e.classList.add("rpc-has-child"),e.querySelector("td:not(.rpc-hidden)").classList.add("rpc-toggler")):(e.classList.remove("rpc-has-child"),e.classList.contains("rpc-expanded")&&(this.#a.rows[e.rowIndex+1].remove(),e.classList.remove("rpc-expanded")))})}#f(i){this.#c<=0?this.render.bind(this):(clearTimeout(this.#d),this.#d=setTimeout(this.render.bind(this),this.#c))}#e(a){if(!a.target.classList.contains("rpc-toggler"))return;let n=a.target.closest("tr");if(n.classList.contains("rpc-expanded")){let d=n.nextSibling;d.querySelectorAll("td > ul.rpc-details > li").forEach(e=>{for(let t of this.#a.rows){if(t.dataset.row!=n.dataset.row)continue;let s=e.querySelector(".rpc-data");s.children.length>0?this.#a.rows[t.rowIndex].cells[parseInt(e.dataset.column)].append(...s.children):this.#a.rows[t.rowIndex].cells[parseInt(e.dataset.column)].innerHTML=s.innerHTML,e.remove();break}}),d.remove()}else{let c=Object.assign(document.createElement("tr"),{classList:["child"],colspan:"100%",innerHTML:`<td class="child" colspan="100%"><ul class="rpc-details" data-row="${n.dataset.row}"></ul></td>`});[...n.getElementsByClassName("rpc-hidden")].forEach(e=>{c.querySelector("td > ul").appendChild(this.#j(e))}),n.after(c)}n.classList.toggle("rpc-expanded")}}