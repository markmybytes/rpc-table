class RpcTable{#a;#b;#c;get tableHeaders(){return[...this.#a.querySelectorAll("tr:nth-child(1) th")].map(e=>e.innerText)}#d;#e;constructor(e,t={}){if(this.#a=document.querySelector(e),!this.#a)throw Error("Invalid selector");this.#a.classList.add("rpc"),this.#b=[],this.#c=t.breakpoints||{"collapse-xs":576,"collapse-sm":768,"collapse-md":992,"collapse-lg":1200,collapse:Number.MAX_SAFE_INTEGER},this.#e=null,this.#d=parseInt(t.resizeTimeout)||150,this.process(),this.#a.addEventListener("click",e=>{if(!e.target.classList.contains("rpc-toggler"))return;let t=e.target.closest("tr");t.classList.contains("rpc-expanded")?t.nextSibling.remove():t.after(this.#b[t.dataset.childIndex]),t.classList.toggle("rpc-expanded")}),window.addEventListener("resize",this.#f.bind(this))}process(){this.#b=[],this.#a.querySelectorAll("tbody tr:not(.child)").forEach(e=>{let t=Object.assign(document.createElement("tr"),{classList:["child"],colspan:"100%",innerHTML:`<td colspan="100%"><ul data-row="${e.rowIndex}"></ul></td>`});e.querySelectorAll("td").forEach((e,s)=>{e.classList.contains("rpc-hidden")&&t.querySelector("td > ul").appendChild(this.#g(e))}),e.dataset.childIndex=this.#b.length,e.dataset.row=e.rowIndex,this.#b.push(t)}),this.render()}render(){this.#h(),this.#a.querySelectorAll("tbody tr:not(.child)").forEach(e=>{let t=this.#b[e.dataset.childIndex],s=t.querySelector("tr > td > ul");for(let l of e.cells){if(l.classList.contains("rpc-hidden")&&!this.#i(t,e.dataset.row,l.cellIndex)){let i=s.children.length;for(;;){if(0==i){s.prepend(this.#g(l));break}if(i--,l.cellIndex>s.children[i].dataset.column){s.children[i].after(this.#g(l));break}}continue}if(!l.classList.contains("rpc-hidden")&&this.#i(t,e.dataset.row,l.cellIndex)){for(let r of s.getElementsByTagName("li"))if(r.dataset.column==l.cellIndex){for(let a of this.#a.rows){if(a.dataset.row!=e.dataset.row)continue;let n=r.querySelector(".rpc-child-value");n.children.length>0?this.#a.rows[a.rowIndex].cells[parseInt(r.dataset.column)].append(...n.children):this.#a.rows[a.rowIndex].cells[parseInt(r.dataset.column)].innerHTML=n.innerHTML,r.remove()}break}continue}}e.querySelector("td.rpc-toggler")?.classList.remove("rpc-toggler"),s.children.length>0?(e.classList.add("has-child"),e.querySelector("td:not(.rpc-hidden)").classList.add("rpc-toggler")):(e.classList.remove("has-child"),e.classList.contains("rpc-expanded")&&(this.#a.rows[e.rowIndex+1].remove(),e.classList.remove("rpc-expanded")))})}hiddenClasses(){return Object.keys(this.#c).filter(e=>this.#c[e]>=window.innerWidth)}#h(){this.#a.querySelectorAll("thead > tr > th").forEach((e,t)=>{let s=[...e.classList].filter(e=>Object.keys(this.#c).includes)[0];this.#a.querySelectorAll(`tbody tr:not(.child) td:nth-child(${t+1})`).forEach(t=>{s&&t.classList.add(s),s&&this.hiddenClasses().includes(s)?(e.classList.add("rpc-hidden"),t.classList.add("rpc-hidden")):(e.classList.remove("rpc-hidden"),t.classList.remove("rpc-hidden"))})})}#i(e,t,s){let l=e.querySelector("ul");for(let i of l.getElementsByTagName("li"))if(l.dataset.row==t&&i.dataset.column==s)return!0;return!1}#g(r){let a=document.createElement("li");return a.dataset.column=r.cellIndex,a.appendChild(Object.assign(document.createElement("span"),{classList:["rpc-child-title"],innerHTML:this.tableHeaders[r.cellIndex]})),a.appendChild(Object.assign(document.createElement("span"),{classList:["rpc-child-value"]})),r.children.length>0?a.children[1].append(...r.children):a.children[1].innerHTML=r.innerText,a}#f(n){this.#d<=0?this.render.bind(this):(clearTimeout(this.#e),this.#e=setTimeout(this.render.bind(this),this.#d))}}